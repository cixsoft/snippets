(function(m){m.sunflower=function(x,y,a,b,c,d){return new n(x,y,a,b,c,d)};m.fn.petal=function(a,b,r,c,d,e){c=c||30;c=c*Math.PI/180;d=d||"";e=e||0;var f=this.set();switch(d){case"outline":var g=r/Math.cos(c/2);var h=r*Math.tan(c/2);var i=r;var j=["M",a,b,"l",-h,-i,"h",h*2,"z"].join();f.push(this.path(j));var k=Math.tan(Math.PI/4-c/4)*h;var l=this.circle(a,b-(r-k),k);f.push(l);break;case"ellipticalarc":var k=Math.tan(Math.PI/4-c/4)*r*Math.tan(c/2);var h=k*Math.cos(c/2);var i=r-k-k*Math.sin(c/2);f.push(this.path(["M",a,b,"l",-h,-i,"A",k,k,0,1,1,a+h,b-i,"z"].join()));break;default:var h=r*Math.sin(c/2);var i=r*Math.cos(c/2);f.push(this.path(["M",a,b,"l",-h,-i,"A",r,r,0,0,1,a+h,b-i,"z"]));break}f.attr({rotation:[e,a,b]});return f};var n=function(x,y,a,b,c,d){a=a||200;b=b||{length:12};c=c||"ellipticalarc";var e=3*a/200,w1=a/200,len="length",count="count",size20=a/20,size2=a/2,petalgroup=[],filledcolors=[],padding=2*a/200,defaultfill="#d0d0d0",t=this;var f=b[len]||b[count]||12;var r=d?m(d,a,a):m(x,y,a,a),xy=padding,wh=a-padding*2;w1<1&&(w1=1);e<1&&(e=1);for(var i=0;i<f;i++){var g=r.petal(size2,size2,size2-padding,360/f,c,360/f*i).attr({stroke:"#fff","stroke-width":2});var h=b[i];if(h){g.attr({fill:h,cursor:"crosshair"});filledcolors.push(h);g.click(function(){t.onclick&&t.onclick(this.attr().fill)})}else{g.attr({fill:defaultfill})}petalgroup.push(g)}t.petalgroup=petalgroup;t.segments=f;t.defaultfill=defaultfill;t.filledcolors=filledcolors};n.prototype.harmoneyColor=function(c,e){e=e||"monochromatic";function applyColor(a){var b=[];for(var i=0;i<this.petalgroup.length;i++){if(a&&a[i]){this.petalgroup[i].attr({fill:a[i]});b.push(a[i]);continue}this.petalgroup[i].attr({fill:this.defaultfill})}return b}function getColorsObject(a){var b={};if(a){for(var i=0;i<a.length;i++){b[parseInt(addH(H,a[i])*this.segments,10)]="hsb("+[addH(H,a[i]),S,B].join(",")+")"}}return b}function addH(h,a){var b=(a/360)%1;b<0&&(b+=1);return(h+b)%1}if(c){c=m.getRGB(c);c=m.rgb2hsb(c.r,c.g,c.b);var d=c.h*360,H=c.h,S=c.s,B=c.b;switch(e){case"monochromatic":this.filledcolors=applyColor.call(this,getColorsObject.call(this,[0]));break;case"complementary":this.filledcolors=applyColor.call(this,getColorsObject.call(this,[0,180]));break;case"splitcomplementary":this.filledcolors=applyColor.call(this,getColorsObject.call(this,[0,150,-150]));break;case"analogous":this.filledcolors=applyColor.call(this,getColorsObject.call(this,[150,180,-150]));break;case"accentedanalogic":this.filledcolors=applyColor.call(this,getColorsObject.call(this,[0,150,180,-150]));break;case"triad":this.filledcolors=applyColor.call(this,getColorsObject.call(this,[0,120,-120]));break;case"tetrad":this.filledcolors=applyColor.call(this,getColorsObject.call(this,[30,-30,150,-150]));break;case"square":this.filledcolors=applyColor.call(this,getColorsObject.call(this,[90,-90,0,180]));break}}else{return this.filledcolors}}})(window.Raphael);